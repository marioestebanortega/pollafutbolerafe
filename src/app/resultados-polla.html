<div class="container py-4">
  <div *ngIf="loading" class="d-flex flex-column align-items-center justify-content-center" style="height: 60vh;">
    <div class="spinner-border text-success" style="width: 4rem; height: 4rem;" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
    <div class="mt-3 fs-3">Cargando <span style="font-size:2rem;">⚽</span></div>
  </div>
  <div *ngIf="error && !loading" [ngClass]="{'alert alert-info text-center mt-5': error === 'Estamos intentando conectarnos, por favor espera un momento...', 'alert alert-danger text-center mt-5': error !== 'Estamos intentando conectarnos, por favor espera un momento...'}">
    <h4 class="alert-heading" *ngIf="error === 'Estamos intentando conectarnos, por favor espera un momento...'">Conectando...</h4>
    <h4 class="alert-heading" *ngIf="error !== 'Estamos intentando conectarnos, por favor espera un momento...'">Error</h4>
    <p>{{ error }}</p>
    <hr>
  
  </div>
  <ng-container *ngIf="resultados && !loading">
    <div class="text-center mb-4">
      <img [src]="resultados.equipos.league.logo" alt="Logo Torneo" style="height:60px;">
      <h1 class="mt-2">{{ resultados.equipos.home.name }} vs {{ resultados.equipos.away.name }}</h1>
      <div class="text-muted">{{ resultados.estadio.nombre }}, {{ resultados.estadio.ciudad }}</div>
      <div class="text-muted">{{ resultados.status.estado }} ({{ resultados.status.minutos }}<span *ngIf="resultados.status.tiempo_extra">+{{ resultados.status.tiempo_extra }}</span>')</div>
    </div>
    <div class="alert alert-info text-center mb-4">
      <strong>¿Cómo se calculan los puntos?</strong><br>
      Ganador: <b>3 puntos</b> &nbsp;|&nbsp;
      Marcador Final: <b>5 puntos</b> &nbsp;|&nbsp;
      1er Tiempo: <b>2 puntos</b> &nbsp;|&nbsp;
      2do Tiempo: <b>2 puntos</b>
    </div>
    <div class="row justify-content-center mb-4">
      <div class="col-auto text-center">
        <img [src]="resultados.equipos.home.logo" alt="Local" style="height:80px;">
        <div class="fw-bold">{{ resultados.equipos.home.name }}</div>
      </div>
      <div class="col-auto align-self-center text-center">
        <div class="fw-bold text-primary" style="font-size:2.2rem;">{{ resultados.resultado_real.final_score }}</div>
      </div>
      <div class="col-auto text-center">
        <img [src]="resultados.equipos.away.logo" alt="Visitante" style="height:80px;">
        <div class="fw-bold">{{ resultados.equipos.away.name }}</div>
      </div>
    </div>
    <div class="container mt-4">
      <div class="d-flex justify-content-end mb-3">
        <button class="btn btn-primary" (click)="irARegistro()">Registrar / Editar predicción</button>
      </div>
    </div>
    <div class="table-responsive">
      <table class="table table-striped table-hover align-middle">
        <thead class="table-dark">
          <tr>
            <th>Posición</th>
            <th>Nombre</th>
            <th>Puntaje</th>
            <th class="text-center">Predicción</th>
            <th>Ganador</th>
            <th>Marcador Final</th>
            <th>1er Tiempo</th>
            <th>2do Tiempo</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let r of resultados.resultados">
            <td>{{ r.posicion }}</td>
            <td>{{ r.name }}</td>
            <td>{{ r.score }}</td>
            <td class="text-center">
              <ng-container>
                <img *ngIf="r.predictions.winner && r.predictions.winner.toLowerCase() === resultados.equipos.home.name.toLowerCase()" [src]="resultados.equipos.home.logo" alt="Local" style="height:32px;">
                <img *ngIf="r.predictions.winner && r.predictions.winner.toLowerCase() === resultados.equipos.away.name.toLowerCase()" [src]="resultados.equipos.away.logo" alt="Visitante" style="height:32px;">
                <span *ngIf="r.predictions.winner && r.predictions.winner.toLowerCase() === 'empate'" class="fs-3 fw-bold text-primary">E</span>
              </ng-container>
            </td>
            <td>{{ r.predictions.winner }}</td>
            <td>{{ r.predictions.final_score }}</td>
            <td>{{ r.predictions.first_half }}</td>
            <td>{{ r.predictions.second_half }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </ng-container>
</div>
